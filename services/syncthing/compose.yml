services:
    syncthing:
        container_name: syncthing
        image: ghcr.io/11notes/syncthing:2
        network_mode: host # Required for autodiscovery. Ports 3000, 22000, and 21027 must be free.
        read_only: true
        restart: unless-stopped
        environment:
            SYNCTHING_API_KEY: ${SYNCTHING_API_KEY} # 32-character API key to use.
            SYNCTHING_PASSWORD: ${SYNCTHING_PASSWORD} # 32-character administrator password to use.
            TZ: ${TZ}
        volumes:
            - syncthing-etc:/syncthing/etc # Configuration volume.
            - syncthing-share:/syncthing/share # Stored data volume.
            - syncthing-var:/syncthing/var # Database and index volume.
        security_opt:
            - no-new-privileges:true

volumes:
    syncthing-etc:
        name: syncthing-etc-volume
        driver_opts:
            device: ${SYNCTHING_DATA_PATH}/etc
            o: bind
            type: none
    syncthing-var:
        name: syncthing-var-volume
        driver_opts:
            device: ${SYNCTHING_DATA_PATH}/var
            o: bind
            type: none
    syncthing-share:
        name: syncthing-share-volume
        driver_opts:
            device: ${SYNCTHING_DATA_PATH}/share
            o: bind
            type: none
